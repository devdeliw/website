+++ 
title = "The Spin Hamiltonian - Part 1" 
description = "NASA 1" 
tags = ["NASA"]
date = "2025-06-06" 
categories = ["Physics"] 
menu = "main"
+++

{{< katex />}}

{{% hint warning %}}
This post is math heavy. I'll try to walk through it all elegantly though. The
important equations are boxed if you'd like to skip through. On mobile some
equations may go overfull. 

{{% /hint %}}

The Spin Hamiltonian $\mathscr{H}$ governs the spin-physics of recombination. It's what we
need to program before starting to simulate EDMR.

$ \mathscr{H} $ is a combination of the [Zeeman
Effect](http://hyperphysics.phy-astr.gsu.edu/hbase/quantum/zeeman.html), [Hyperfine Interactions](https://bohr.physics.berkeley.edu/classes/221/1112/notes/hyperfine.pdf),
the [Zero-Field Splitting
Effect](https://en.wikipedia.org/wiki/Zero-field_splitting), and the [Exchange Interaction](https://en.wikipedia.org/wiki/Exchange_interaction). 

$$
\mathscr{H} = 
\hat{H}\_{\mathrm{Z}}   + 
\hat{H}\_{\mathrm{HF}}  + 
\hat{H}\_{\mathrm{ZFS}} + 
\hat{H}\_{\mathrm{EX}}
$$ 

Normally $\mathscr{H}$ also has a "[Nuclear Quadrupole Interaction
Hamiltonian](https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Supplemental_Modules_(Physical_and_Theoretical_Chemistry)/Spectroscopy/Magnetic_Resonance_Spectroscopies/Nuclear_Magnetic_Resonance/NMR_-_Theory/NMR_Interactions/Quadrupolar_Coupling)"
as well. But since Silicon Carbide (4H-SiC) has no nuclei with nuclear spin $I >
1/2$, it's set to 0. 

The goal of this post is to provide a concise derivation of the first two Hamiltonian terms. 
The next two are reviewed in the next post. 

I use a fancy $\mathscr{H}$ to represent the full Spin Hamiltonian.
Sub-Hamiltonians are normal $H$'s but with hats (e.g. $\hat{H}_Z$). 

---

## The Zeeman Effect 

> $\hat{H}_Z$ determines how spin-state energies split in the presence of an external $\vec{B}$ field. 
It's the dominant term in the Spin Hamiltonian that drives recombination.

A spinning charged particle is a magnetic dipole. Its magnetic dipole moment,
$\vec{\mu}$, is proportional to its spin angular momentum, $\vec{S}$ 

$$ \vec{\mu} = \gamma \vec{S}.$$

The proportionality constant, $\gamma$ is the *gyromagnetic ratio.* From the
Dirac equation it can be shown 

$$
\vec{\mu} = \gamma \vec{S} = -g \frac{q}{2m\_e} \vec{S} = -\frac{g\mu\_B}{\hbar}
\vec{S}, 
$$

where $g \approx 2.0023$ is the Land√© $g$-factor for the free electron
and $\mu_B \approx 9.2 \cdot 10^{-24} J/T $ is the Bohr Magneton.  

When a magnetic dipole is placed in a magnetic field $\vec{B}$, it experiences
a torque, $\vec{\mu} \times \vec{B}$, which tends to line it up parallel to the
field like a compass. The energy associated with this torque is 

$$
\begin{align} 
H = -\vec{\mu} \cdot \vec{B} = -\gamma \vec{B} \cdot \vec{S}. 
\end{align} 
$$

Therefore, the Zeeman Hamiltonian is 

$$
\hat{H}_Z = -\vec{\mu} \cdot \vec{B}_0 = \frac{g\mu_B}{\hbar} \vec{S} \cdot
\vec{B}_0 = \frac{g\mu_B}{\hbar}B_0 S_z
$$    

where $S_z = \frac{\hbar}{2} \hat{\sigma}_z$ and $\sigma_z$ is the Pauli-$z$ spin
matrix. Applying $\hat{H}_Z$ on an arbitrary spin state $|s, m_s\rangle$ gives 

$$
\begin{align}
\hat{H}_Z |s, m_s\rangle &= \frac{g\mu_B}{\hbar}B_0 \cdot S_z |s, m_s\rangle
\\\\ &= \frac{g\mu_B}{\hbar}B_0 \cdot m_s\hbar|s, m_s\rangle \\\\ 
&= m_s g \mu_B B_0 |s, m_s\rangle. 
\end{align}
$$

From Equation (4) above, we can calculate $\hat{H}_Z$'s effect on any spin state
$|s, m_s\rangle$. 

<br> 

<p align="center">
  <img src="/zeeman.svg">
</p>

<br>

Ordinarily we use an anisotropic $g$-tensor. Magnetic fields in different
directions act differently on $|s, m_s\rangle$. So we would replace with a $3 \times 3$ $g$
tensor, 

$$\hat{H}_Z = \mu_B \vec{S} \cdot g \cdot \vec{B}_0.$$

This can be diagonalized along $|s, m_s\rangle$'s principle axis to make things easier.  

$$ g\_{\mathrm{diag}} = \begin{pmatrix} g_x & 0 & 0 \\\\ 0 & g_y & 0 \\\\ 0 & 0
& g_z \end{pmatrix}. $$

For our simulation though, we'll start with $g \approx 2.0023$. 
Our Zeeman Hamiltonian is given by   

$$ 
\boxed { 
\hat{H}_Z |s, m_s\rangle = m_s g \mu_B B_0 |s, m_s\rangle.
}
$$

--- 

## Hyperfine Interaction

> The hyperfine interaction comes from the magnetic field generated by the
nucleus $\vec{B}(\vec{r})$ acting on
the magnetic moment of an orbiting electron. We will calculate
$\vec{B}(\vec{r})$ and use Equation (1) to calculate $\hat{H}\_{HF}$. 

Maxwell's Equations say 

$$
\nabla \cdot \vec{B} = 0, \quad \nabla \times \vec{B} = \mu_0 \vec{J}. 
$$

### Vector Potential

The first equation tells us there's no magnetic monopoles; the magnetic field
$\vec{B}$ has zero divergence. From vector calculus this means there exists a
vector field $\vec{A}$ such that 

$$
\vec{B} = \nabla \times \vec{A}. 
$$

$A$ isn't unique, but to make math simple we can impose the Coulomb gauge condition
$ \nabla \cdot \vec{A} = 0.$ Substituting yields 

$$ 
\begin{align}
\nabla^2 \vec{A} = -\mu_0 \vec{J}. 
\end{align}
$$

### Current Density 

$\vec{J}$ is called the "current density." We know current is the *amount of
charge per unit time* that travels through a wire (i.e. electron flux). If
electrons aren't trapped in a wire, they flow throughout space. At every point in this space 
we can assign a small vector that says 

"*Here's how much charge is flowing through this point, and in what direction.*"

This vector field is the current density $\vec{J}$. If we model the localized nuclear magnetic moment
$\vec{\mu}_n$ at the origin, it generates an effective current density 

$$ \vec{J}_n(\vec{r}') = \nabla' \times [\vec{\mu}_n \delta^3 (\vec{r}')]. $$ 

The general solution for $\vec{A}$ in Equation (5) is 

$$
\vec{A}(\vec{r}) = \frac{\mu_0}{4\pi} \int d^3 r' \\, \frac{\vec{J}_n
(\vec{r}')}{|\vec{r} - \vec{r}'|} = \frac{\mu_0}{4\pi} \vec{\mu}_n \times \nabla
\left( \frac{1}{r} \right) = \frac{\mu_0}{4\pi}\frac{\vec{\mu}_n \times
\vec{r}}{r^3}. 
$$

Then, using the identity 

$$
\nabla \times (\vec{a} \times \vec{r}f(r)) = \vec{a} \nabla \cdot (\vec{r}f) -
(\vec{a} \cdot \nabla)(\vec{r} f),
$$

with $\vec{a} = \vec{\mu}_n$ and $f(r) = 1/r^3$, we get the canonical expression
for a magnetic field from a dipole in classical electrodynamics: 

$$
\begin{align}
\vec{B}(\vec{r}) = \frac{\mu_0}{4\pi r^3} \left[ 3(\vec{\mu}_n \cdot \hat{r})
\hat{r} - \vec{\mu}_n \right] + \frac{2\mu_0}{3}\vec{\mu}_n \delta^3 (\vec{r}).
\end{align} 
$$

### Hamiltonian Density 

A magnetic moment $\vec{\mu}_e$ at $\vec{r}$ has energy (Equation (1)) 

$$
U(\vec{r}) = -\vec{\mu}_e \cdot \vec{B}(\vec{r}). 
$$

Substituting $\vec{B}(\vec{r})$ with the expression in Equation (6), we can
separate the energy into two terms: 

$$
\begin{align} 
U\_{\text{dipolar}}(\vec{r}) &= -\vec{\mu}_e \cdot \left[ \frac{\mu_0}{4\pi r^3}
(3(\vec{\mu}_n \cdot \hat{r}) \hat{r} - \vec{\mu}_n) \right],\\\\ 
U\_{\text{contact}}(\vec{r}) &= -\vec{\mu}_e \cdot \left[ \frac{2\mu_0}{3}
\vec{\mu}_n \delta^3 (\vec{r})\right]. 
\end{align}
$$

Promoting magnetic moments to their "quantum operators", 

$$
\begin{align} 
\vec{\mu}_e &= -g_e \mu_B \frac{\hat{S}}{\hbar}, \\\\ 
\vec{\mu}_n &= +g_n \mu_N \frac{\hat{I}}{\hbar},
\end{align}
$$

where the Bohr Magneton $\mu_B = e\hbar / (2m_e)$ and the Nuclear Magneton $\mu_N = e\hbar / (2m_p)$. 
Now we can substitute everything into Equation (1) to calculate the Hamiltonian of the
electron, in the magnetic field generated from the nuclei's magnetic dipole
moment at $\vec{r}$. 

$$
H(\vec{r}) = \frac{\mu_0}{4\pi} \frac{g_e \mu_B g_n \mu_N}{\hbar^2} \left(
\frac{\vec{S} \cdot \vec{I} - 3(\vec{S} \cdot \hat{r})(\vec{I} \cdot
\hat{r})}{r^3} + \frac{8\pi}{3} \delta^3(\vec{r}) \vec{S} \cdot \vec{I} \right). 
$$

The first term before the parenthesis is just a constant $C$. If an electron
occupies a spatial wave function, $\psi(\vec{r})$, the full Hyperfine
Hamiltonian is 

$$
\hat{H}\_{HF} = \int d^3 r \\, |\psi(\vec{r})|^2 H(\vec{r}). 
$$

Now we can solve. We'll write the Hamiltonian in index form, 

$$
H(\vec{r}) = C \left[ \frac{1}{r^3}(\delta_{kl} - 3\hat{r}_k \hat{r}_l)
S_k I_l + \frac{8\pi}{3}\delta^3 (\vec{r}) S_k I_k \right],
$$

where we sum over repeated indices. Now the final expression to solve is 

$$
\hat{H}\_{HF} = C \left[ \underbrace{S_k I_l \int d^3 |\psi(\vec{r})|^2 \frac{\delta\_{kl} -
3\hat{r}_k\hat{r}_l}{r^3}}\_{\text{dipolar term}} + \underbrace{\frac{8\pi}{3}S_k I_k \int d^3 r |\psi(\vec{r})|^2
\delta^3 (\vec{r})}\_{\text{contact (isotropic) term}} \right].
$$

The contact term reduces to 

$$
\begin{align} 
\frac{8\pi}{3} S_k I_k \int d^3 |\psi(\vec{r})|^2  \delta^3(\vec{r}) &=
\frac{8\pi}{3} |\psi(0)|^2 S_k I_k \\\\
&= A\_{\text{iso}} \delta_kl S_k I_l, 
\end{align} 
$$

where $A\_{\text{iso}} = C \frac{8\pi}{3}|\psi(0)|^2. $ To solve the dipolar
term, we define 

$$
A_{kl}^{\text{dip}} = C \int d^3 r |\psi(\vec{r})|^2 \frac{\delta_{kl} -
3\hat{r}_k \hat{r}_l}{r^3}. 
$$

Then the dipolar term reduces to $S_k I_l A_{kl}^{\text{dip}}.$ We define the
$A_{ij}$ tensor as 

$$
A_{ij} = A\_{\text{iso}} \delta_{ij} + A_{ij}^{\text{dip}}. 
$$

Finally, 

$$
\boxed{
\hat{H}\_{HF} = \hat{S} \cdot A \cdot \hat{I} = \hat{S}\_i A_{ij} \hat{I}_j. 
}
$$

For multiple nuclei, like in Silicon Carbide, we sum over every $j$ inequivalent
nucleus. 

$$
\hat{H}\_{HF} = \sum_j \hat{\vec{S}} \cdot A_j \cdot \hat{\vec{I}}_j. 
$$

For a 2-nuclei (Silicon + Carbon) $\times$ 2-electron (Defect +
Carrier) system, the Hilbert space is $2^4 = 16$ dimensional. The Hyperfine
Hamiltonian is a $16\times 16$ matrix.  

Making a $B_0$ vs. Energy plot for Hyperfine like with
Zeeman above is difficult. However, in a future post, we'll generate it.
I will be writing some "eigen-energy" simulations. These will let us see what the Hyperfine
Interaction does to the 16 basis states defining our spin-system at play.  
